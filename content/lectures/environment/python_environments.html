<!DOCTYPE html>
<html lang="en">
  

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Managing Python Environments</title>
  <meta name="description" content="An introduction to Earth and Environmental Data Science with Python.">

  <link rel="canonical" href="http://earth-env-data-science.github.io//content/lectures/environment/python_environments.html">
  <link rel="alternate" type="application/rss+xml" title="Earth and Environmental Data Science" href="http://earth-env-data-science.github.io//feed.xml">

  <meta property="og:url"         content="http://earth-env-data-science.github.io//content/lectures/environment/python_environments.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Managing Python Environments" />
<meta property="og:description" content="An introduction to Earth and Environmental Data Science with Python." />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "http://earth-env-data-science.github.io//content/lectures/environment/python_environments.html",
  "headline":
    "Managing Python Environments",
  "datePublished":
    "2019-11-11T20:45:00+00:00",
  "dateModified":
    "2019-11-11T20:45:00+00:00",
  "description":
    "An introduction to Earth and Environmental Data Science with Python.",
  "author": {
    "@type": "Person",
    "name": "Ryan Abernathey"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://earth-env-data-science.github.io/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://earth-env-data-science.github.io/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="/assets/js/anchor.min.js"  type="text/javascript"></script>
  <script>

initFunction(function () {
    anchors.add("main h1, main h2, main h3, main h4")
});

</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC -->
  <script src="/assets/js/tocbot.min.js"  type="text/javascript"></script>
  <script>
var initToc = function () {
  tocbot.init({
    tocSelector: 'nav.onthispage',
    contentSelector: '.c-textbook__content',
    headingSelector: 'h2, h3',
    orderedList: false,
    collapseDepth: 6,
    listClass: 'toc__menu',
    activeListItemClass: "",  // Not using
    activeLinkClass: "", // Not using
  });
  tocbot.refresh();
}
initFunction(initToc);
</script>

  <!-- Google analytics -->
  <script src="/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a id="copy-button-${id}" class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('div.c-textbook__content > div.highlighter-rouge > div.highlight > pre, div.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("copy-button" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>


  <!-- Hide cell code -->
  <script>
    /**
    Add buttons to hide code cells
    */


    var setCodeCellVisibility = function (inputField, kind) {
        // Update the image and class for hidden
        var id = inputField.getAttribute('data-id');
        var codeCell = document.querySelector(`#${id} div.highlight`);

        if (kind === "visible") {
            codeCell.classList.remove('hidden');
            inputField.checked = true;
        } else {
            codeCell.classList.add('hidden');
            inputField.checked = false;
        }
    }

    var toggleCodeCellVisibility = function (event) {
        // The label is clicked, and now we decide what to do based on the input field's clicked status
        if (event.target.tagName === "LABEL") {
            var inputField = event.target.previousElementSibling;
        } else {
            // It is the span inside the target
            var inputField = event.target.parentElement.previousElementSibling;
        }

        if (inputField.checked === true) {
            setCodeCellVisibility(inputField, "visible");
        } else {
            setCodeCellVisibility(inputField, "hidden");
        }
    }


    // Button constructor
    const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

    var addHideButton = function () {
        // If a hide button is already added, don't add another
        if (document.querySelector('div.hidecode input') !== null) {
            return;
        }

        // Find the input cells and add a hide button
        document.querySelectorAll('div.input_area').forEach(function (item, index) {
            if (!item.classList.contains("hidecode")) {
                // Skip the cell if it doesn't have a hidecode class
                return;
            }

            const id = codeCellId(index)
            item.setAttribute('id', id);
            // Insert the button just inside the end of the next div
            item.querySelector('div').insertAdjacentHTML('beforeend', hideCodeButton(id))

            // Set up the visibility toggle
            hideLink = document.querySelector(`#${id} div.highlight + input + label`);
            hideLink.addEventListener('click', toggleCodeCellVisibility)
        });
    }


    // Initialize the hide buttos
    var initHiddenCells = function () {
        // Add hide buttons to the cells
        addHideButton();

        // Toggle the code cells that should be hidden
        document.querySelectorAll('div.hidecode input').forEach(function (item) {
            setCodeCellVisibility(item, 'hidden');
            item.checked = true;
        })
    }

    initFunction(initHiddenCells);

</script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("http://earth-env-data-science.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("https://ocean.pangeo.io", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="/assets/js/lunr/lunr.min.js" type="text/javascript"></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="http://earth-env-data-science.github.io"><img src="/images/logo/eeds-logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Earth and Environmental Data Science</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/intro.html"
        >
          
          Intro
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/LICENSE.html"
        >
          
          License
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">The Interactive Computing Environment</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/environment/intro_to_jupyterlab.html"
        >
          
            1.
          
          Intro to JupyterLab
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/environment/intro_to_unix.html"
        >
          
            2.
          
          Intro to Unix
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/environment/intro_to_git.html"
        >
          
            3.
          
          Intro to Git
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/files_markdown_git.html"
                >
                  
                    3.1
                  
                  Assignment: Files, Git, and Github
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry c-sidebar__entry--active"
          href="/lectures/environment/python_environments.html"
        >
          
            4.
          
          Managing Environments
        </a>

        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">The Core Python Language</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/core_python/python_fundamentals.html"
        >
          
            5.
          
          Python Fundamentals
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/core_python/functions_classes.html"
        >
          
            6.
          
          Functions and Classes
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/python_basics_and_functions.html"
                >
                  
                    6.1
                  
                  Assignment: Python Basics and Functions
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/core_python/organization_and_packaging.html"
        >
          
            7.
          
          Organization and Packaging of Python Projects
        </a>

        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Scientific Python Fundamentals</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/basic_scipy/numpy_and_matplotlib.html"
        >
          
            8.
          
          Numpy and Matplotlib
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/numpy_matplotlib.html"
                >
                  
                    8.1
                  
                  Assignment: Basic Numpy and Matplotlib
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/basic_scipy/more_matplotlib.html"
        >
          
            9.
          
          Advanced Matplotlib
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/more_matplotlib.html"
                >
                  
                    9.1
                  
                  Assignment: More Matplotlib
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">High Level Data Analysis Frameworks</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/pandas/pandas_intro.html"
        >
          
            10.
          
          Pandas for Tabular Data
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/lectures/pandas/basic_pandas.html"
                >
                  
                    10.1
                  
                  Pandas Fundamentals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/basic_pandas.html"
                >
                  
                    10.2
                  
                  Assignment: Pandas Fundamentals with Earthquake Data
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/lectures/pandas/pandas_groupby.html"
                >
                  
                    10.3
                  
                  The Split-Apply-Combine Workflow
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/pandas_groupby.html"
                >
                  
                    10.4
                  
                  Assignment: Pandas Groupby with Hurrican Data
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/xarray/xarray_intro.html"
        >
          
            11.
          
          Xarray for Multidimensional Data
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/lectures/xarray/xarray.html"
                >
                  
                    11.1
                  
                  Xarray Fundamentals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/basic_xarray.html"
                >
                  
                    11.2
                  
                  Assignment: Xarray Fundamentals with Earth Radiation Data
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/lectures/xarray/xarray-part2.html"
                >
                  
                    11.3
                  
                  Intermediate Xarray
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/xarray_groupby.html"
                >
                  
                    11.4
                  
                  Assignment: Xarray Groupby and SST Data
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/lectures/xarray/xarray_tips_and_tricks.html"
                >
                  
                    11.5
                  
                  Xarray Tips And Tricks
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Geoscience Packages</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/mapping_cartopy.html"
        >
          
            12.
          
          Making Maps with Cartopy
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/assignments/cartopy.html"
                >
                  
                    12.1
                  
                  Assignment: Maps with Cartopy
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/lectures/working_with_gcm_data.html"
        >
          
            13.
          
          Working with output from general circulation models using xesmf and xgcm
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
      <aside class="sidebar__right">
          <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
          <nav class="onthispage">
          </nav>
      </aside>
      
      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            

            <div class="c-textbook__content">
              <h1 id="managing-python-environments">Managing Python Environments</h1>

<p><em>Note: many elements in this guide are adapted from
<a href="http://danielrothenberg.com/">Daniel Rothenberg</a>’s excellent
<a href="http://danielrothenberg.com/gcpy/getting_started.html">getting started guide</a>.</em></p>

<h2 id="python">Python</h2>

<p>Python and nearly all of the software packages in the scientific python
ecosystem are <a href="https://opensource.org/">open-source</a>.
They are maintained and developed by a community of scientists and programmers,
some of whose work is supported by universities, non-profits, and for-profit
corporations.
This work mostly happens in the open, via <a href="http://github.com/">github</a> and other
online collaboration platforms.</p>

<p>Because there is no single authority which controls all of these packages, it
can be intimidating for new users to figure out how to set up a functional
scientific python environment.
Coordinating the compatibility between these different packages and their
multiple versions used to be a nightmare!
Fortunately, the problem is solved completely by using a Python <em>distribution</em>
and / or a Python <em>package manager</em> (described in detail below).</p>

<p>The only hard-and-fast rule about scientific computing in Python is this:</p>

<p><strong>Do not use your system Python installation!</strong></p>

<p>The version of Python that ships with operating systems such as Red Hat Linux and
macOS is usually outdated and configured to support system functions. Although it
is entirely possible to install and use the necessary packages using the system
Python, it’s much more practical on both
your local machine and any other computers you work with to use a specialized Python
installation.</p>

<p><strong>Should I use Python 2 or Python 3?</strong></p>

<p>You should use Python 3. The majority of the scientific Python packages are
<a href="http://www.python3statement.org/">now support only Python 3</a> in the
near future without any backwards compatibility. The differences between
Python 2 and Python 3 are mostly superficial, but large enough that it is
cumbersome to maintain large codebases that are compatible with both. With the
exception of a handful of packages you may encounter which do not support
Python 3, there is no compelling reason to use Python 2 today.</p>

<h2 id="recommended-installation-method-use-anaconda-python">Recommended Installation Method: Use Anaconda Python</h2>

<p>The easiest way to set up a full-stack scientific Python deployment is to use a
Python distribution. This is an installation of Python with a set of curated
packages which are guaranteed to work together.
For this class, we recommend the
<strong><a href="https://www.anaconda.com/download/">Anaconda Python Distribution</a></strong>.
Follow the link above to obtain a one-click installer for Linux, Mac, or
Windows.
(Make sure you select the Python 3 installer, not Python 2.7.)
In addition to the packages themselves, Anaconda includes a graphical
utility to help manage any packages you may want to install which are not
already included in the default inclusion list.</p>

<h2 id="accessing-the-command-line">Accessing the Command Line</h2>

<p>These notes assume you have access to a Unix command line to type in shell commands.
For Linux and MacOS users, you can access the command line by opening the <em>terminal</em> program.
It’s more difficult for Windows users.
For Windows users, you should first install Anaconda (described above) or Miniconda (described below), which gives you access to the “Anaconda Prompt” desktop app.
(Instructions for this are given on the <a href="https://docs.anaconda.com/anaconda/user-guide/getting-started/#write-a-python-program-using-anaconda-prompt-or-terminal">Andaconda Website</a>.)
From the Anaconda Prompt, you should be able to run <code class="highlighter-rouge">conda</code> and other shell commands.</p>

<h2 id="lightweight-alternative-miniconda">Lightweight Alternative: Miniconda</h2>

<p>If you are installing python on a remote machine via ssh, or you simply don’t
want to download a huge file like the Anaconda Python Distribution, there is a
lightweight alternative installation method.</p>

<ol>
  <li>
    <p><strong>Obtain a minimal Python installer</strong>
  We recommend the <a href="https://conda.io/miniconda.html">Miniconda</a> installer;
  this provides a Python install for your operating system, plus the <strong>conda</strong>
  package manager. This way, you can only install the packages you <em>want</em>.</p>
  </li>
  <li>
    <p><strong>Run the installer</strong>
  You’ll probably need to do this from the command line, e.g.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sh Miniconda3-latest-MacOSX-x86_64.sh
</code></pre></div>    </div>
  </li>
</ol>

<p>Follow the instructions; you can choose where to place the installation (
  preferably somewhere you have write access without super-user/root access,
  like your home directory). At the end of this process, add this path to your
  *rc configuration</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ echo ". $HOME/miniconda3/etc/profile.d/conda.sh" &gt; ~/.bashrc
</code></pre></div></div>

<p>If you do this, your <code class="highlighter-rouge">$PYTHONPATH</code> will be implicitly configured correctly
  and you will never have to touch it.</p>

<ol>
  <li><strong>Create an environment and install packages.</strong>
  This is described in the next section.</li>
</ol>

<h2 id="managing-environments-with-conda">Managing Environments with Conda</h2>

<p>Python coupled with a package manager provides a way to make isolated,
reproducible <em>environments</em> where you have fine-tuned control over all packages
and configuration. <strong>You should always work within an environment</strong>, rather
than the “default” environment.</p>

<p>It is strongly recommended to read official
<a href="https://conda.io/docs/user-guide/getting-started.html#">Getting Started with Conda</a>
guide.</p>

<p>To create a conda environment, you execute the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda create --name my_environment python=3.7 numpy
</code></pre></div></div>

<p>This will create a special environment in <code class="highlighter-rouge">$MINICONDA_HOME/envs/my_environment</code>
with only Python and numpy to begin with. Here, we’ve also told conda to install
Python version 3.7; you can specify exact versions or minima, and conda will
take care of figuring out all the compatibilties between versions for you. To use
this environment, simply “activate” it by executing:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda activate my_environment
</code></pre></div></div>

<p>Regardless of your shell, you should now see the string <code class="highlighter-rouge">(my_environment)</code>
prepended to your prompt. Now, if you execute any Python-related tool from the
command line, it will first search in <code class="highlighter-rouge">$MINICONDA_HOME/envs/my_environment/bin</code>
to find them. You can deactivate your environment by typing:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda deactivate
</code></pre></div></div>

<p>To see all the environments on your system:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda info --envs
</code></pre></div></div>

<p>If you want to permanently remove an environment and delete all the data
associated with it:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda remove --name my_environment --all
</code></pre></div></div>

<p>For extensive documentation on using environments, please see
<a href="https://conda.io/docs/using/envs.html">the conda documentation</a>. The most
important feature to review here is the ability to <em>share and export</em> your
environment; this is the basis for reproducibility in the scientific Python stack.
At any time from the shell, you can execute</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda list
</code></pre></div></div>

<p>to get a complete summary of all the packages installed in your environment, the
channel they were installed from, and their full version info. Using this info,
you can create an <strong>environment file</strong> in
<a href="http://docs.ansible.com/ansible/latest/YAMLSyntax.html">YAML syntax</a>
which documents the exact
contents of your environment. With that file, a new environment with the exact
configuration can be installed by executing</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda env create -f my_environment.yml
</code></pre></div></div>

<h2 id="geosciences-python-environment">Geosciences Python Environment</h2>

<p>Combining all of the previous sections, we can very easily spin-up a
full-featured scientific Python environment with a set of packages curated for the
geosciences. Copy and paste the following <code class="highlighter-rouge">environment.yml</code> file somewhere
on your local hard drive:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>name: rces
channels:
    - conda-forge
    - defaults
dependencies:
    - python=3.7    # Python version 3.7
    - basemap       # mapping package
    - bottleneck    # C-optimized array functions for NumPy
    - cartopy       # Geographic plotting toolkit
    - dask          # Parallel processing library
    - h5py          # Wrapper for HDF5
    - ipython       # IPython interpreter and tools
    - jupyter       # Jupyter federation architecture
    - jupyterlab    # Jupyter Lab environment
    - matplotlib    # 2D plotting library
    - netcdf4       # Wrapper for netcdf4
    - numpy         # N-d array and numerics
    - numba         # For speeding up python code
    - pandas        # Labeled array library
    - proj4         # geographic projections
    - pyresample    # Geographic resampling tools
    - scipy         # Common math/stats/science functions
    - scikit-learn  # Macine learning library
    - scikit-image  # Image processing routines
    - statsmodels   # Regression/modeling toolkit
    - seaborn       # Statistical visualizations
    - tqdm          # Nice progress bar for longer computations
    - xarray        # N-d labeled array library
    - xesmf         # Geographical regridding based on ESMF
    - xgcm          # Tools for working with finite-volume grids
    - zarr          # Array storage library
    - numcodecs     # Compression library used by zarr
    - gcsfs         # Access data from Google Cloud Storage
    - s3fs          # Access data from Amazon S3
</code></pre></div></div>

<p>(<strong>Note:</strong>
Installing this environment will also install many dependencies, including
compiled libraries. This is totally fine; even if you have these libraries
already installed through your system package manager, <strong>conda</strong> will install
and link for use in the environment a configuration which should be to play
nicely and work with all of its components.)</p>

<p>Create this environment through <strong>conda</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda env create -f environment.yml
</code></pre></div></div>

<p>Activate this environment</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source activate rces
</code></pre></div></div>

<p>This environment should be sufficient for all of your work in this class.</p>

<h2 id="installing-more-packages">Installing More Packages</h2>

<p>Once you have a basic Python environment, you can easily add or remove packages
using the <a href="https://conda.io/">conda</a> command line utility.
Conda was created to help manage the complex dependencies and
pre-compiled binary libraries that are necessary in scientific python.</p>

<p>If you set up your python environment using the Anaconda Python Distribution or
with miniconda, you should already have the <strong>conda</strong> command available on
the command line.
With it, you can easily install packages from an official, curated set of packages which are
built and tested for a number of different system configurations on Linux,
Windows, and macOS</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda install &lt;package-name&gt;
</code></pre></div></div>

<p>Additionally, there is a
community-maintained collection of packages/recipes called
<a href="https://conda-forge.github.io/&gt;">conda forge</a>
which is accessible through conda as a special “channel”</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ conda install -c conda-forge &lt;package-name&gt;
</code></pre></div></div>

<p>While conda allows you to install almost any science-related package, there may
be other general-use python packages you wish to you that are not available in
via conda. For these, you can use an alternative installation method.</p>

<p>Outside of the scientific python community,
the most common way to install packages is to search for them on the official
<a href="https://pypi.python.org/pypi">PyPI</a> index. Once you’ve found the package you
want to install (you may have also just found it on github or elsewhere), you
use the <strong>pip</strong> command from a the command line:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ pip install &lt;package-name&gt;
</code></pre></div></div>

<p>This will fetch the source code, build it, and install it to wherever your
<code class="highlighter-rouge">$PYTHONPATH</code> is set. This works in the vast majority of cases, particularly
when the code you’re installing doesn’t have any compiled dependencies.</p>

<p>If you
can’t find a package on either PyPI or conda-forge, you can always install it
directly from the source code. If the package is on github, <code class="highlighter-rouge">pip</code> already has
an alias to do this for you:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ pip install git+https://github.com/&lt;user&gt;/&lt;package-name&gt;.git
</code></pre></div></div>

<p>If all else fails, you can always download the source code and install it manually
like</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ wget https:/path/to/my/pkg/source.tar.gz
$ tar -xvzf source.tar.gz
$ cd source/
$ python setup.py install
</code></pre></div></div>

<p>You can also use <code class="highlighter-rouge">pip</code> to install code you’ve downloaded:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd source/
$ pip install -e .
</code></pre></div></div>

<p>This will automatically call <strong>setup.py</strong> for you. The “<strong>-e</strong>” flag will
install the package in “editable” mode, which means that any change you make
to the source code will automatically be recognized when you load the package
in Python; this is <em>especially</em> useful when you’re developing code.</p>

<p>Finally, you don’t <em>have</em> to go through this process of installing packages. If you
have code sitting on your disk somewhere, you can always modify the environmental
variable <code class="highlighter-rouge">$PYTHONPATH</code> to include a path to that code, and Python will find it
for you. However, you <em>should not do this</em> if it can be avoided, because it is
extremely difficult (if not impossible) to be sure that any compiled code will
link against the correct libraries it needs, and it is very hard to debug errors
associated with mis-matched libraries/headers if you go this route.</p>

              <nav class="c-page__nav">
  

  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
